---
title: "Modulo_2"
author: "Fernando Alvarado"
date: "2025-04-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 游늭 Lectura de datos Excel `.xlsx` con `readxl` y exploraci칩n r치pida con `skimr`

- Para leer archivos Excel (.xls y .xlsx) usamos el paquete `readxl`.

- La funci칩n principal es: `read_xlsx("ruta", sheet = "nombre_hoja")`.

- El archivo debe estar ubicado en la misma carpeta del script o se debe indicar su ruta.

- Para explorar r치pidamente un dataframe, `skimr::skim()` genera estad칤sticas resumen por variable.

- Esta salida se puede guardar y analizar como un dataframe de metadatos.




```{r message=FALSE, warning=FALSE}


library(readxl)   # Leer archivos de Excel
library(dplyr)    # Manipulaci칩n de datos
library(ggplot2)  # Visualizaci칩n
library(lubridate) # Manejo de fechas
library(skimr)    # Exploraci칩n estructurada de dataframes

# ------------------------------------------------------
# 游닌 Lectura del archivo Excel con la hoja "Ventas"
setwd("C:/Users/ferna/Documents/Diplomado_Data_Sience/Estudio/Data")

datos_ventas <- read_xlsx("./datos_simulados.xlsx")
datos_ventas

# 游늶 Revisi칩n de la estructura general del dataframe
str(datos_ventas)

# 游늵 Exploraci칩n detallada con skim()
skim(datos_ventas)

# 游 Guardar el resultado de skim() en un objeto para inspecci칩n
mi_metadata <- skim(datos_ventas)
str(mi_metadata)

# 游댌 Acceder a los tipos de variable que detect칩 skimr
mi_metadata$skim_type

```



## 游늰 Manejo de fechas con `lubridate` y creaci칩n de variables temporales

```{r message=FALSE, warning=FALSE}
### 游닇 Resumen

# - Muchas veces las fechas est치n mal codificadas como texto (string). Debemos convertirlas con as.Date().
# - El paquete {lubridate} permite extraer partes 칰tiles como el d칤a, mes, a침o o d칤a de la semana.
# - Una vez que las fechas est치n en formato Date, podemos crear nuevas columnas que representen:
#     - El tiempo entre eventos (entrega, procesamiento, salida).
#     - El mes, d칤a o d칤a de la semana de cada fecha.
#
# - Operaciones entre fechas (restas) devuelven diferencias en d칤as por defecto.
# - Aseg칰rate que todas las fechas est칠n en el **mismo formato** antes de operar.

# ------------------------------------------------------
# 游닍 Librer칤as necesarias
library(dplyr)
library(readxl)
library(lubridate)

# 游닌 Leer archivo Excel (usamos tu archivo de referencia)
datos_ventas <- read_xlsx("./datos_simulados.xlsx", sheet = "Ventas")

# ------------------------------------------------------
# 游댢 Paso 1: Convertimos `Fecha Venta` a formato Date y extraemos partes
datos_ventas <- datos_ventas %>%
  mutate(`Fecha Venta` = as.Date(`Fecha Venta`, format = "%d/%m/%Y")) %>%
  mutate(
    MesVenta = month(`Fecha Venta`),     # mes num칠rico
    DiaVenta = day(`Fecha Venta`),       # d칤a del mes
    DiaSemana = wday(`Fecha Venta`)      # d칤a de la semana (1 = domingo)
  )

head(datos_ventas)

# ------------------------------------------------------
# 游댢 Paso 2: Homogeneizamos formato de otras columnas de fecha
datos_ventas <- datos_ventas %>%
  mutate(
    FecEntrg = as.Date(FechaEntrega, format = "%d/%m/%Y"),
    FecSalida = as.Date(FechaCamino, format = "%d/%m/%Y")
  )

# ------------------------------------------------------
# 游댢 Paso 3: Creamos variables de tiempo
datos_ventas <- datos_ventas %>%
  mutate(
    TiempoEntrega = FecEntrg - `Fecha Venta`,
    TiempoCalle   = FecEntrg - FecSalida,
    TiempoProces  = FecSalida - `Fecha Venta`
  )

head(datos_ventas)
```


































