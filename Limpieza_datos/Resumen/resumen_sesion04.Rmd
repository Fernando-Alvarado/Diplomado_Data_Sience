---
title: "Resumen - Sesi贸n 04"
output: html_document
---

# Resumen de funciones y conceptos: Sesi贸n 04

Esta sesi贸n aborda dos temas fundamentales:
1. El manejo de fechas importadas desde Excel.
2. El tratamiento de variables categ贸ricas como factores y la transformaci贸n de datos usando `tidyr`.

---

##  Librer铆as utilizadas

```{r}
library(ggplot2)   # Visualizaci贸n de datos
library(tidyr)     # Transformaci贸n de datos (pivot_longer)
library(readxl)    # (Impl铆cito en funciones de fechas)
library(janitor)   # Utilidades como top_levels()
```

---

##  Manejo de fechas desde Excel

Cuando Excel guarda fechas como n煤meros (por ejemplo, 42223), es necesario convertirlas a formato `Date` en R.

### `excel_numeric_to_date()`

Convierte n煤meros seriales de Excel a fechas reales en R.

```{r}
excel_numeric_to_date(41103)                # Fecha b谩sica
excel_numeric_to_date(41103.01)             # Ignora parte decimal por defecto
excel_numeric_to_date(41103.01, include_time = TRUE)  # Incluye hora
excel_numeric_to_date(41103.01, date_system = "mac pre-2011") # Otra codificaci贸n
```

---

### `convert_to_date()` y `convert_to_datetime()`

Funciones m谩s robustas para tratar m煤ltiples formatos de fechas, ideal para archivos con fechas mezcladas o inconsistentes.

```{r}
convert_to_date(c("2020-02-29", "40000.1"))                # Funciona
convert_to_date(c("2020-02-29", "26-04-2021"))             # Error por formato
convert_to_date(c("2020-02-29", "04-26-2021"))             # Formato aceptado
```

> Nota: No todos los formatos son compatibles, y puede ser necesario estandarizar antes.

---

##  Factores en R

Las variables categ贸ricas ordenadas se representan como `factor`.

```{r}
mi_vector <- c("strongly agree", "agree", "neutral", "neutral", 
               "disagree", "strongly agree", "agree", "neutral", "neutral")

mi_vector <- factor(mi_vector,
                    levels = c("strongly agree", "agree", "neutral", 
                               "disagree", "strongly disagree"))
```

### `top_levels()`

Funci贸n 煤til para ver los niveles m谩s frecuentes:

```{r}
top_levels(mi_vector)     # Todos los niveles ordenados por frecuencia
top_levels(mi_vector, n = 1) # Solo el m谩s com煤n
```

---

##  Transformaci贸n de datos con `pivot_longer()`

Permite pasar de formato **ancho** a **largo**, 煤til cuando las columnas representan valores de una misma variable en distintos periodos.

```{r}
df <- data.frame(estudiante = c('Pedro', 'Pablo', 'Lorena', 'Eugenia'),
                 mes1 = c(8, 10, 6, 5),
                 mes2 = c(9, 4, 7, 8))

df_largo <- df |> tidyr::pivot_longer(
  cols = c('mes1', 'mes2'),
  names_to = 'periodo',
  values_to = 'calificacion'
)
```

- `names_to`: nuevo nombre para las columnas convertidas.
- `values_to`: nuevo nombre para los valores asociados.

---

Esta sesi贸n cubre aspectos esenciales del tratamiento de datos reales: conversi贸n de formatos inconsistentes y estructuras categ贸ricas, junto con t茅cnicas fundamentales para limpiar y reorganizar datasets.
